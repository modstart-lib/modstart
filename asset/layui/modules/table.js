layui.define(["laytpl","laypage","layer","form","util"],function(e){"use strict";function a(e){var t=h.config[e];return t||y.error(e?"The table instance with ID '"+e+"' not found":"ID argument required"),t||null}function m(e,t,i,a){return(this.config||{}).escape&&(t=l.escape(t)),t=e.templet?"function"==typeof e.templet?e.templet(i):b(v(e.templet).html()||String(t)).render(i):t,a?v("<div>"+t+"</div>").text():t}function t(e){return['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',(e=e||{}).fixed&&"right"!==e.fixed?'{{# if(item2.fixed && item2.fixed !== "right"){ }}':"right"===e.fixed?'{{# if(item2.fixed === "right"){ }}':"","{{# var isSort = !(item2.colGroup) && item2.sort; }}",'<th data-field="{{ item2.field||i2 }}" data-key="{{d.index}}-{{i1}}-{{i2}}" {{# if( item2.parentKey){ }}data-parentkey="{{ item2.parentKey }}"{{# } }} {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} {{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}} {{# if(item2.unresize || item2.colGroup){ }}data-unresize="true"{{# } }} class="{{# if(item2.hide){ }}layui-hide{{# } }}{{# if(isSort){ }} layui-unselect{{# } }}{{# if(!item2.field){ }} layui-table-col-special{{# } }}">','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colGroup){ }}","group","{{# } else { }}","{{d.index}}-{{i1}}-{{i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose" {{# if(item2[d.data.checkName]){ }}checked{{# }; }}>',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(isSort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc" title="升序"></i><i class="layui-edge layui-table-sort-desc" title="降序"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",e.fixed?"{{# }; }}":"","{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")}function i(e){this.index=++x.index,this.config=v.extend({},this.config,x.config,e),this.render()}var v=layui.$,b=layui.laytpl,o=layui.laypage,g=layui.layer,u=layui.form,l=layui.util,y=layui.hint(),f=layui.device(),x={config:{checkName:"LAY_CHECKED",indexName:"LAY_TABLE_INDEX"},cache:{},index:layui.table?layui.table.index+1e4:0,set:function(e){var t=this;return t.config=v.extend({},t.config,e),t},on:function(e,t){return layui.onevent.call(this,p,e,t)}},h=function(){var i=this,e=i.config,t=e.id||e.index;return t&&(h.that[t]=i,h.config[t]=e),{config:e,reload:function(e,t){i.reload.call(i,e,t)},setColsWidth:function(){i.setColsWidth.call(i)},resize:function(){i.resize.call(i)}}},p="table",k="layui-hide",d="layui-none",n="layui-table-view",c=".layui-table-header",w=".layui-table-body",C=".layui-table-sort",T="layui-table-edit",A="layui-table-hover",r=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),s=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}{{# if(d.data.className){ }} {{ d.data.className }}{{# } }}" lay-filter="LAY-table-{{d.index}}" lay-id="{{ d.data.id }}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# if(d.data.loading){ }}",'<div class="layui-table-init" style="background-color: #fff;">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>","{{# } }}","{{# var left, right; }}",'<div class="layui-table-header">',t(),"</div>",'<div class="layui-table-body layui-table-main">',r,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',t({fixed:!0}),"</div>",'<div class="layui-table-body">',r,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',t({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',r,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.totalRow){ }}",'<div class="layui-table-total">','<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>','<tbody><tr><td><div class="layui-table-cell" style="visibility: hidden;">Total</div></td></tr></tbody>',"</table>","</div>","{{# } }}","{{# if(d.data.page){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","<style>","{{# layui.each(d.data.cols, function(i1, item1){","layui.each(item1, function(i2, item2){ }}",".laytable-cell-{{d.index}}-{{i1}}-{{i2}}{ ","{{# if(item2.width){ }}","width: {{item2.width}}px;","{{# } }}"," }","{{# });","}); }}","</style>","</div>"].join(""),N=v(window),S=v(document);i.prototype.config={limit:10,loading:!0,cellMinWidth:60,defaultToolbar:["filter","exports","print"],autoScrollTop:!0,autoColumnWidth:!1,autoSort:!0,text:{none:"无数据"}},String.prototype.contentWidth=function(e,t,i){i=i||!1;var a=t||e.css("font"),t=v("<div></div>");i?t.text(this):t.html(this),t.css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:a}).appendTo(e);e=t.width();return t.remove(),e},i.prototype.render=function(){var e=this,t=e.config;if(t.elem=v(t.elem),t.where=t.where||{},t.id=t.id||t.elem.attr("id")||e.index,t.request=v.extend({pageName:"page",limitName:"limit"},t.request),t.response=v.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",totalRowName:"totalRow",countName:"count"},t.response),"object"==typeof t.page&&(t.limit=t.page.limit||t.limit,t.limits=t.page.limits||t.limits,e.page=t.page.curr=t.page.curr||1,delete t.page.elem,delete t.page.jump),!t.elem[0])return e;t.height&&/^full-\d+$/.test(t.height)&&(e.fullHeightGap=t.height.split("-")[1],t.height=N.height()-e.fullHeightGap),e.setInit();var i=t.elem,a=i.next("."+n),l=e.elem=v(b(s).render({VIEW_CLASS:n,data:t,index:e.index}));t.index=e.index,e.key=t.id||t.index,a[0]&&a.remove(),i.after(l),e.layTool=l.find(".layui-table-tool"),e.layBox=l.find(".layui-table-box"),e.layHeader=l.find(c),e.layMain=l.find(".layui-table-main"),e.layBody=l.find(w),e.layFixed=l.find(".layui-table-fixed"),e.layFixLeft=l.find(".layui-table-fixed-l"),e.layFixRight=l.find(".layui-table-fixed-r"),e.layTotal=l.find(".layui-table-total"),e.layPage=l.find(".layui-table-page"),e.renderToolbar(),e.fullSize(),1<t.cols.length&&(t=e.layFixed.find(c).find("th")).height(e.layHeader.height()-1-parseFloat(t.css("padding-top"))-parseFloat(t.css("padding-bottom"))),e.pullData(e.page),e.events()},i.prototype.initOpts=function(e){this.config;e.checkbox&&(e.type="checkbox"),e.space&&(e.type="space"),e.type||(e.type="normal"),"normal"!==e.type&&(e.unresize=!0,e.width=e.width||{checkbox:48,radio:48,space:15,numbers:40}[e.type])},i.prototype.setInit=function(e){var a,t=this,o=t.config;if(o.clientWidth=o.width||(a=function(e){var t,i=(e=e||o.elem.parent()).width();try{t="none"===e.css("display")}catch(e){}return!e[0]||i&&!t?i:a(e.parent())})(),"width"===e)return o.clientWidth;layui.each(o.cols,function(n,e){layui.each(e,function(i,a){var l;a?(a.key=n+"-"+i,a.hide=a.hide||!1,(a.colGroup||1<a.colspan)&&(l=0,layui.each(o.cols[n+1],function(e,t){t.HAS_PARENT||1<l&&l==a.colspan||(t.HAS_PARENT=!0,t.parentKey=n+"-"+i,l+=parseInt(1<t.colspan?t.colspan:1))}),a.colGroup=!0),t.initOpts(a)):e.splice(i,1)})})},i.prototype.renderToolbar=function(){var e=this.config,t=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),i=this.layTool.find(".layui-table-tool-temp");"default"===e.toolbar?i.html(t):"string"!=typeof e.toolbar||(t=v(e.toolbar).html()||"")&&i.html(b(t).render(e));var a={filter:{title:"筛选列",layEvent:"LAYTABLE_COLS",icon:"layui-icon-cols"},exports:{title:"导出",layEvent:"LAYTABLE_EXPORT",icon:"layui-icon-export"},print:{title:"打印",layEvent:"LAYTABLE_PRINT",icon:"layui-icon-print"}},l=[];"object"==typeof e.defaultToolbar&&layui.each(e.defaultToolbar,function(e,t){t="string"==typeof t?a[t]:t;t&&l.push('<div class="layui-inline" title="'+t.title+'" lay-event="'+t.layEvent+'"><i class="layui-icon '+t.icon+'"></i></div>')}),this.layTool.find(".layui-table-tool-self").html(l.join(""))},i.prototype.setParentCol=function(e,t){var i=this.config,a=this.layHeader.find('th[data-key="'+i.index+"-"+t+'"]'),l=parseInt(a.attr("colspan"))||0;a[0]&&(t=t.split("-"),t=i.cols[t[0]][t[1]],e?l--:l++,a.attr("colspan",l),a[l<1?"addClass":"removeClass"](k),t.colspan=l,t.hide=l<1,(a=a.data("parentkey"))&&this.setParentCol(e,a))},i.prototype.setColsPatch=function(){var i=this,e=i.config;layui.each(e.cols,function(e,t){layui.each(t,function(e,t){t.hide&&i.setParentCol(t.hide,t.parentKey)})})},i.prototype.setColsWidth=function(){var h=this,o=h.config,i=0,d=0,c=0,r=0,s=h.setInit("width");h.eachCols(function(e,t){t.hide||i++});var s=s-("line"===o.skin||"nob"===o.skin?2:i+1)-h.getScrollWidth(h.layMain[0])-1,e=function(n){layui.each(o.cols,function(e,l){layui.each(l,function(e,t){var i=0,a=t.minWidth||o.cellMinWidth;t?t.colGroup||t.hide||(n?c&&c<a&&(d--,i=a):(i=t.width||0,/\d+%$/.test(i)?(i=Math.floor(parseFloat(i)/100*s))<a&&(i=a):i||(t.width=i=0,d++)),t.hide&&(i=0),r+=i):l.splice(e,1)})}),r<s&&d&&(c=(s-r)/d)};e(),e(!0),h.autoColNums=d,h.eachCols(function(e,t){var i=t.minWidth||o.cellMinWidth;t.colGroup||t.hide||(0===t.width?h.getCssRule(o.index+"-"+t.key,function(e){e.style.width=Math.floor(i<=c?c:i)+"px"}):/\d+%$/.test(t.width)&&h.getCssRule(o.index+"-"+t.key,function(e){e.style.width=Math.floor(parseFloat(t.width)/100*s)+"px"}))});var t,a,l,n,u=h.layMain.width()-h.getScrollWidth(h.layMain[0])-h.layMain.children("table").outerWidth();h.autoColNums&&-i<=u&&u<=i&&(e=(a=(t=function(e){return!(e=e||h.layHeader.eq(0).find("thead th:last-child")).data("field")&&e.prev()[0]?t(e.prev()):e})()).data("key"),h.getCssRule(e,function(e){var t=e.style.width||a.outerWidth();e.style.width=parseFloat(t)+u+"px",0<h.layMain.height()-h.layMain.prop("clientHeight")&&(e.style.width=parseFloat(e.style.width)-1+"px")})),o.autoColumnWidth&&function(){var d=v("body"),e=h.elem.children(".layui-table-box").children(".layui-table-header").children("table").children("thead").children("tr").children("th"),t=h.elem.children(".layui-table-box").children(".layui-table-fixed").children(".layui-table-header").children("table").children("thead").children("tr").children("th"),c=h.elem.children(".layui-table-box").children(".layui-table-body").children("table").children("tbody").children("tr"),r=h.elem.children(".layui-table-total").find("tr");e.add(t).on("dblclick",function(e){var t=v(this),i=e.clientX-t.offset().left,e=t.attr("data-key").split("-"),e=h.config.cols[e[1]][e[2]];s(t,0<t.parents(".layui-table-fixed-r").length?i<=10:t.width()-i<=10,e),o(t,0<t.parents(".layui-table-fixed-r").length?i<=10:t.width()-i<=10,e)});var a=0,l=0,n={};function o(e,t,i){var a=e.data("key"),l=a.split("-");3===l.length&&(l[1],l[2]);1<e.attr("colspan")||e.data("unresize")||t&&h.getCssRule(a,function(e){e.style.width=i.width+"px"})}function s(e,t,i){var a,l,n=e.data("key"),o=n.split("-");3===o.length&&(o[1],o[2]);1<e.attr("colspan")||e.data("unresize")||t&&(i.widthAutoOld=e.width(),a=e.text().contentWidth(d,e.css("font"))+21,l=e.css("font"),c.children('td[data-key="'+n+'"]').each(function(e,t){var i=0;v(this).children().children()&&0<v(this).children().children().length?i+=v(this).children().html().contentWidth(d,l):i=v(this).text().contentWidth(d,l,!0),a<i&&(a=i)}),0<r.length&&(n=r.children('td[data-key="'+n+'"]').text().contentWidth(d,l),a<n&&(a=n)),a+=32,a=Math.min(a,500),i.width=a,i.widthAutoSize=a)}e.add(t).each(function(e,t){var i=v(this).attr("data-key").split("-"),i=h.config.cols[i[1]][i[2]];!0===i.withAuto&&(s(v(this),!0,i),"widthAutoSize"in i&&"widthAutoOld"in i&&(n[i.field]||(n[i.field]=!0,a+=i.widthAutoOld,a-=i.widthAutoSize,l++)))}),0<a&&0<l&&l<=a&&e.add(t).each(function(e,t){var i=v(this).attr("data-key").split("-"),i=h.config.cols[i[1]][i[2]];!0===i.withAuto&&(i.width=i.widthAutoSize+a/l)}),e.add(t).each(function(e,t){var i=v(this).attr("data-key").split("-"),i=h.config.cols[i[1]][i[2]];!0===i.withAuto&&o(v(this),!0,i)})}(),l=h.elem.children(".layui-table-box").children(".layui-table-fixed"),n=h.elem.find(".layui-table-body:first table > tbody > tr"),l.each(function(e,t){v(t).find("table > tbody > tr").each(function(e,t){e=n.find("td:first").get(e).getBoundingClientRect().height;v(t).find("td:first").css({height:e+"px"})})}),h.loading(!0)},i.prototype.resize=function(){this.fullSize(),this.setColsWidth(),this.scrollPatch()},i.prototype.reload=function(e,t){var i=this;e=e||{},delete i.haveInit,layui.each(e,function(e,t){"array"===layui._typeof(t)&&delete i.config[e]}),i.config=v.extend(t,{},i.config,e),i.render()},i.prototype.errorView=function(e){var t=this,i=t.layMain.find("."+d),e=v('<div class="'+d+'">'+(e||"Error")+"</div>");i[0]&&(t.layNone.remove(),i.remove()),t.layFixed.addClass(k),t.layMain.find("tbody").html(""),t.layMain.append(t.layNone=e),x.cache[t.key]=[]},i.prototype.page=1,i.prototype.pullData=function(t){function i(){"object"==typeof n.initSort&&l.sort(n.initSort.field,n.initSort.type)}var e,a,l=this,n=l.config,o=n.request,d=n.response;l.startTime=(new Date).getTime(),n.url?((a={})[o.pageName]=t,a[o.limitName]=n.limit,e=v.extend(a,n.where),n.contentType&&0==n.contentType.indexOf("application/json")&&(e=JSON.stringify(e)),l.loading(),v.ajax({type:n.method||"get",url:n.url,contentType:n.contentType,data:e,dataType:"json",headers:n.headers||{},success:function(e){(e="function"==typeof n.parseData?n.parseData(e)||e:e)[d.statusName]!=d.statusCode?(l.renderForm(),l.errorView(e[d.msgName]||'返回的数据不符合规范，正确的成功状态码应为："'+d.statusName+'": '+d.statusCode)):(l.renderData(e,t,e[d.countName]),i(),n.time=(new Date).getTime()-l.startTime+" ms"),l.setColsWidth(),"function"==typeof n.done&&n.done(e,t,e[d.countName])},error:function(e,t){l.errorView("请求异常，错误提示："+t),l.renderForm(),l.setColsWidth(),"function"==typeof n.error&&n.error(e,t)}})):"array"===layui._typeof(n.data)&&(a=t*n.limit-n.limit,(e={})[d.dataName]=n.data.concat().splice(a,n.limit),e[d.countName]=n.data.length,"object"==typeof n.totalRow&&(e[d.totalRowName]=v.extend({},n.totalRow)),l.renderData(e,t,e[d.countName]),i(),l.setColsWidth(),"function"==typeof n.done&&n.done(e,t,e[d.countName]))},i.prototype.eachCols=function(e){return x.eachCols(null,e,this.config.cols),this},i.prototype.renderData=function(e,t,i,a){var h=this,u=h.config,l=e[u.response.dataName]||[],n=e[u.response.totalRowName],y=[],f=[],p=[],e=function(){var s;if(!a&&h.sortKey)return h.sort(h.sortKey.field,h.sortKey.sort,!0);layui.each(l,function(l,n){var o=[],d=[],c=[],r=l+u.limit*(t-1)+1;"array"===layui._typeof(n)&&0===n.length||(a||(n[x.config.indexName]=l),h.eachCols(function(e,i){var t=i.field||e,e=u.index+"-"+i.key,a=n[t];null==a&&(a=""),i.colGroup||(e=['<td data-field="'+t+'" data-key="'+e+'" '+(t=[],i.edit&&t.push('data-edit="'+i.edit+'"'),i.align&&t.push('align="'+i.align+'"'),i.templet&&t.push('data-content="'+a+'"'),i.toolbar&&t.push('data-off="true"'),i.event&&t.push('lay-event="'+i.event+'"'),i.style&&t.push('style="'+i.style+'"'),i.minWidth&&t.push('data-minwidth="'+i.minWidth+'"'),t.join(" "))+' class="'+(t=[],i.hide&&t.push(k),i.field||t.push("layui-table-col-special"),t.join(" "))+'">','<div class="layui-table-cell laytable-cell-'+("normal"===i.type?e:e+" laytable-cell-"+i.type)+'">'+function(){var e=v.extend(!0,{LAY_INDEX:r,LAY_COL:i},n),t=x.config.checkName;switch(i.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+(i[t]?(n[t]=i[t],i[t]?"checked":""):e[t]?"checked":"")+">";case"radio":return e[t]&&(s=l),'<input type="radio" name="layTableRadio_'+u.index+'" '+(e[t]?"checked":"")+' lay-type="layTableRadio">';case"numbers":return r}return i.toolbar?b(v(i.toolbar).html()||"").render(e):m.call(h,i,a,e)}(),"</div></td>"].join(""),o.push(e),i.fixed&&"right"!==i.fixed&&d.push(e),"right"===i.fixed&&c.push(e))}),y.push('<tr data-index="'+l+'">'+o.join("")+"</tr>"),f.push('<tr data-index="'+l+'">'+d.join("")+"</tr>"),p.push('<tr data-index="'+l+'">'+c.join("")+"</tr>"))}),u.autoScrollTop&&h.layBody.scrollTop(0),h.layMain.find("."+d).remove(),h.layMain.find("tbody").html(y.join("")),h.layFixLeft.find("tbody").html(f.join("")),h.layFixRight.find("tbody").html(p.join("")),h.renderForm(),"number"==typeof s&&h.setThisRowChecked(s),h.syncCheckAll(),h.haveInit?h.scrollPatch():setTimeout(function(){h.scrollPatch()},50),h.haveInit=!0,g.close(h.tipsIndex),u.HAS_SET_COLS_PATCH||h.setColsPatch(),u.HAS_SET_COLS_PATCH=!0};return x.cache[h.key]=l,h.layPage[0==i||0===l.length&&1==t?"addClass":"removeClass"](k),0===l.length?(h.renderForm(),h.errorView(u.text.none)):(h.layFixed.removeClass(k),a?e():(e(),h.renderTotal(l,n),void(u.page&&(u.page=v.extend({elem:"layui-table-page"+u.index,count:i,limit:u.limit,limits:u.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(e,t){t||(h.page=e.curr,u.limit=e.limit,h.pullData(e.curr))}},u.page),u.page.count=i,o.render(u.page)))))},i.prototype.renderTotal=function(e,n){var o,d=this,c=d.config,r={};c.totalRow&&(layui.each(e,function(e,a){"array"===layui._typeof(a)&&0===a.length||d.eachCols(function(e,t){var i=t.field||e,e=a[i];t.totalRow&&(r[i]=(r[i]||0)+(parseFloat(e)||0))})}),d.dataTotal={},o=[],d.eachCols(function(e,t){var i,a,l=t.field||e,e=(i=t.totalRowText||"",a=parseFloat(r[l]).toFixed(2),(e={})[l]=a,i=t.totalRow&&m.call(d,t,a,e)||i,n&&n[t.field]||i),i=['<td data-field="'+l+'" data-key="'+c.index+"-"+t.key+'" '+(i=[],t.align&&i.push('align="'+t.align+'"'),t.style&&i.push('style="'+t.style+'"'),t.minWidth&&i.push('data-minwidth="'+t.minWidth+'"'),i.join(" "))+' class="'+(i=[],t.hide&&i.push(k),t.field||i.push("layui-table-col-special"),i.join(" "))+'">','<div class="layui-table-cell laytable-cell-'+(i=c.index+"-"+t.key,"normal"===t.type?i:i+" laytable-cell-"+t.type)+'">'+("string"==typeof(i=t.totalRow||c.totalRow)?b(i).render(v.extend({TOTAL_NUMS:e},t)):e),"</div></td>"].join("");t.field&&(d.dataTotal[l]=e),o.push(i)}),d.layTotal.find("tbody").html("<tr>"+o.join("")+"</tr>"))},i.prototype.getColElem=function(e,t){var i=this.config;return e.eq(0).find(".laytable-cell-"+i.index+"-"+t+":eq(0)")},i.prototype.renderForm=function(e){u.render(e,"LAY-table-"+this.index)},i.prototype.setThisRowChecked=function(e){this.config;var t="layui-table-click";this.layBody.find('tr[data-index="'+e+'"]').addClass(t).siblings("tr").removeClass(t)},i.prototype.sort=function(l,e,t,i){var a,n=this,o={},d=n.config,c=d.elem.attr("lay-filter"),r=x.cache[n.key];"string"==typeof l&&(s=l,n.layHeader.find("th").each(function(e,t){var i=v(this),a=i.data("field");if(a===l)return l=i,s=a,!1}));try{var s=s||l.data("field"),h=l.data("key");if(n.sortKey&&!t&&s===n.sortKey.field&&e===n.sortKey.sort)return;var u=n.layHeader.find("th .laytable-cell-"+h).find(C);n.layHeader.find("th").find(C).removeAttr("lay-sort"),u.attr("lay-sort",e||null),n.layFixed.find("th")}catch(e){y.error("Table modules: sort field '"+s+"' not matched")}n.sortKey={field:s,sort:e},d.autoSort&&("asc"===e?a=layui.sort(r,s):"desc"===e?a=layui.sort(r,s,!0):(a=layui.sort(r,x.config.indexName),delete n.sortKey)),o[d.response.dataName]=a||r,n.renderData(o,n.page,n.count,!0),i&&layui.event.call(l,p,"sort("+c+")",{field:s,type:e})},i.prototype.loading=function(e){var t=this;t.config.loading&&(e?(t.layInit&&t.layInit.remove(),delete t.layInit,t.layBox.find(".layui-table-init").remove()):(t.layInit=v(['<div class="layui-table-init">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>"].join("")),t.layBox.append(t.layInit)))},i.prototype.setCheckData=function(e,t){var i=this.config,a=x.cache[this.key];a[e]&&"array"!==layui._typeof(a[e])&&(a[e][i.checkName]=t)},i.prototype.syncCheckAll=function(){function e(i){return t.eachCols(function(e,t){"checkbox"===t.type&&(t[a.checkName]=i)}),i}var t=this,a=t.config,i=t.layHeader.find('input[name="layTableCheckbox"]');i[0]&&(x.checkStatus(t.key).isAll?(i[0].checked||(i.prop("checked",!0),t.renderForm("checkbox")),e(!0)):(i[0].checked&&(i.prop("checked",!1),t.renderForm("checkbox")),e(!1)))},i.prototype.getCssRule=function(i,a){var e=this.elem.find("style")[0],e=e.sheet||e.styleSheet||{},e=e.cssRules||e.rules;layui.each(e,function(e,t){if(t.selectorText===".laytable-cell-"+i)return a(t),!0})},i.prototype.fullSize=function(){var e=this,t=e.config,i=t.height;e.fullHeightGap&&(i=N.height()-e.fullHeightGap,e.elem.css("height",i=i<135?135:i)),i&&(i=parseFloat(i)-(e.layHeader.outerHeight()||38),t.toolbar&&(i-=e.layTool.outerHeight()||50),t.totalRow&&(i-=e.layTotal.outerHeight()||40),t.page&&(i-=e.layPage.outerHeight()||41),e.layMain.css("height",i-2))},i.prototype.getScrollWidth=function(e){var t=0;return e?t=e.offsetWidth-e.clientWidth:((e=document.createElement("div")).style.width="100px",e.style.height="100px",e.style.overflowY="scroll",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth,document.body.removeChild(e)),t},i.prototype.scrollPatch=function(){var e=this,t=e.layMain.children("table"),i=e.layMain.width()-e.layMain.prop("clientWidth"),a=e.layMain.height()-e.layMain.prop("clientHeight"),l=(e.getScrollWidth(e.layMain[0]),t.outerWidth()-e.layMain.width()),n=function(e){var t;i&&a?(e=e.eq(0)).find(".layui-table-patch")[0]||((t=v('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>')).find("div").css({width:i}),e.find("tr").append(t)):e.find(".layui-table-patch").remove()};n(e.layHeader),n(e.layTotal);n=e.layMain.height()-a;e.layFixed.find(w).css("height",t.height()>=n?n:"auto"),e.layFixRight[0<l?"removeClass":"addClass"](k),e.layFixRight.css("right",i-1)},i.prototype.events=function(){var l,c=this,r=c.config,a=v("body"),n={},e=c.layHeader.find("th"),o=".layui-table-cell",s=r.elem.attr("lay-filter");c.layTool.on("click","*[lay-event]",function(e){function t(e){var t=v(e.list),i=v('<ul class="layui-table-tool-panel"></ul>');i.html(t),r.height&&i.css("max-height",r.height-(c.layTool.outerHeight()||50)),a.find(".layui-table-tool-panel")[0]||a.append(i),c.renderForm(),i.on("click",function(e){layui.stope(e)}),e.done&&e.done(i,t)}var i,a=v(this),l=a.attr("lay-event");switch(layui.stope(e),S.trigger("table.tool.panel.remove"),g.close(c.tipsIndex),l){case"LAYTABLE_COLS":t({list:(i=[],c.eachCols(function(e,t){t.field&&"normal"==t.type&&i.push('<li><input type="checkbox" name="'+t.field+'" data-key="'+t.key+'" data-parentkey="'+(t.parentKey||"")+'" lay-skin="primary" '+(t.hide?"":"checked")+' title="'+(t.title||t.field)+'" lay-filter="LAY_TABLE_TOOL_COLS"></li>')}),i.join("")),done:function(){u.on("checkbox(LAY_TABLE_TOOL_COLS)",function(e){var e=v(e.elem),a=this.checked,l=e.data("key"),n=e.data("parentkey");layui.each(r.cols,function(i,e){layui.each(e,function(e,t){i+"-"+e===l&&(e=t.hide,t.hide=!a,c.elem.find('*[data-key="'+r.index+"-"+l+'"]')[a?"removeClass":"addClass"](k),e!=t.hide&&c.setParentCol(!a,n),c.resize())})})})}});break;case"LAYTABLE_EXPORT":f.ie?g.tips("导出功能不支持 IE，请用 Chrome 等高级浏览器导出",this,{tips:3}):t({list:['<li data-type="csv">导出到 Csv 文件</li>','<li data-type="xls">导出到 Excel 文件</li>'].join(""),done:function(e,t){t.on("click",function(){var e=v(this).data("type");x.exportFile.call(c,r.id,null,e)})}});break;case"LAYTABLE_PRINT":var n=window.open("打印窗口","_blank"),o=["<style>","body{font-size: 12px; color: #666;}","table{width: 100%; border-collapse: collapse; border-spacing: 0;}","th,td{line-height: 20px; padding: 9px 15px; border: 1px solid #ccc; text-align: left; font-size: 12px; color: #666;}","a{color: #666; text-decoration:none;}","*.layui-hide{display: none}","</style>"].join(""),d=v(c.layHeader.html());d.append(c.layMain.find("table").html()),d.append(c.layTotal.find("table").html()),d.find("th.layui-table-patch").remove(),d.find(".layui-table-col-special").remove(),n.document.write(o+d.prop("outerHTML")),n.document.close(),n.print(),n.close()}layui.event.call(this,p,"toolbar("+s+")",v.extend({event:l,config:r},{}))}),e.on("mousemove",function(e){var t=v(this),i=t.offset().left,i=e.clientX-i;t.data("unresize")||n.resizeStart||(n.allowResize=t.width()-i<=10,a.css("cursor",n.allowResize?"col-resize":""))}).on("mouseleave",function(){v(this);n.resizeStart||a.css("cursor","")}).on("mousedown",function(e){var t,i=v(this);n.allowResize&&(t=i.data("key"),e.preventDefault(),n.resizeStart=!0,n.offset=[e.clientX,e.clientY],c.getCssRule(t,function(e){var t=e.style.width||i.outerWidth();n.rule=e,n.ruleWidth=parseFloat(t),n.minWidth=i.data("minwidth")||r.cellMinWidth}))}),S.on("mousemove",function(e){n.resizeStart&&(e.preventDefault(),n.rule&&((e=n.ruleWidth+e.clientX-n.offset[0])<n.minWidth&&(e=n.minWidth),n.rule.style.width=e+"px",g.close(c.tipsIndex)),l=1)}).on("mouseup",function(e){n.resizeStart&&(n={},a.css("cursor",""),c.scrollPatch()),2===l&&(l=null)}),e.on("click",function(e){var t=v(this),i=t.find(C),a=i.attr("lay-sort");if(!i[0]||1===l)return l=2;c.sort(t,"asc"===a?"desc":"desc"===a?null:"asc",null,!0)}).find(C+" .layui-edge ").on("click",function(e){var t=v(this),i=t.index(),t=t.parents("th").eq(0).data("field");layui.stope(e),0===i?c.sort(t,"asc",null,!0):c.sort(t,"desc",null,!0)});function d(e){var t=v(this).parents("tr").eq(0).data("index"),l=c.layBody.find('tr[data-index="'+t+'"]'),n=(n=x.cache[c.key]||[])[t]||{};return v.extend({tr:l,data:x.clearCacheKey(n),del:function(){x.cache[c.key][t]=[],l.remove(),c.scrollPatch()},update:function(e){e=e||{},layui.each(e,function(i,e){var a,t;i in n&&(t=l.children('td[data-field="'+i+'"]'),n[i]=e,c.eachCols(function(e,t){t.field==i&&t.templet&&(a=t.templet)}),t.children(o).html(m.call(c,{templet:a},e,n)),t.data("content",e))})}},e)}c.elem.on("click",'input[name="layTableCheckbox"]+',function(){var e=v(this).prev(),t=c.layBody.find('input[name="layTableCheckbox"]'),i=e.parents("tr").eq(0).data("index"),a=e[0].checked,l="layTableAllChoose"===e.attr("lay-filter");l?(t.each(function(e,t){t.checked=a,c.setCheckData(e,a)}),c.syncCheckAll(),c.renderForm("checkbox")):(c.setCheckData(i,a),c.syncCheckAll()),layui.event.call(e[0],p,"checkbox("+s+")",d.call(e[0],{checked:a,type:l?"all":"one"}))}),c.elem.on("click",'input[lay-type="layTableRadio"]+',function(){var e=v(this).prev(),t=e[0].checked,i=x.cache[c.key],a=e.parents("tr").eq(0).data("index");layui.each(i,function(e,t){a===e?t[r.checkName]=!0:delete t[r.checkName]}),c.setThisRowChecked(a),layui.event.call(this,p,"radio("+s+")",d.call(this,{checked:t}))}),c.layBody.on("mouseenter","tr",function(){var e=v(this),t=e.index();e.data("off")||c.layBody.find("tr:eq("+t+")").addClass(A)}).on("mouseleave","tr",function(){var e=v(this),t=e.index();e.data("off")||c.layBody.find("tr:eq("+t+")").removeClass(A)}).on("click","tr",function(){t.call(this,"row")}).on("dblclick","tr",function(){t.call(this,"rowDouble")});var t=function(e){var t=v(this);t.data("off")||layui.event.call(this,p,e+"("+s+")",d.call(t.children("td")[0]))};c.layBody.on("change","."+T,function(){var e=v(this),t=this.value,i=e.parent().data("field"),e=e.parents("tr").eq(0).data("index");x.cache[c.key][e][i]=t,layui.event.call(this,p,"edit("+s+")",d.call(this,{value:t,field:i}))}).on("blur","."+T,function(){var i,e=v(this),a=e.parent().data("field"),t=e.parents("tr").eq(0).data("index"),l=x.cache[c.key][t];c.eachCols(function(e,t){t.field==a&&t.templet&&(i=t.templet)}),e.siblings(o).html((t=this.value,m.call(c,{templet:i},t,l))),e.parent().data("content",this.value),e.remove()}),c.layBody.on("click","td",function(e){var t=v(this),i=(t.data("field"),t.data("edit")),a=t.children(o);t.data("off")||i&&((i=v('<input class="layui-input '+T+'">'))[0].value=t.data("content")||a.text(),t.find("."+T)[0]||t.append(i),i.focus(),layui.stope(e))}).on("mouseenter","td",function(){i.call(this)}).on("mouseleave","td",function(){i.call(this,"hide")});var h="layui-table-grid-down",i=function(e){var t=v(this),i=t.children(o);t.data("off")||(e?t.find(".layui-table-grid-down").remove():i.prop("scrollWidth")>i.outerWidth()&&(i.find("."+h)[0]||t.append('<div class="'+h+'"><i class="layui-icon layui-icon-down"></i></div>')))};c.layBody.on("click","."+h,function(e){var t=v(this).parent().children(o);c.tipsIndex=g.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(t.height()+16)+"px;"+("sm"===r.size?"padding: 4px 15px; font-size: 12px;":"lg"===r.size?"padding: 14px 15px;":"")+'">',t.html(),"</div>",'<i class="layui-icon layui-table-tips-c layui-icon-close"></i>'].join(""),t[0],{tips:[3,""],time:-1,anim:-1,maxWidth:f.ios||f.android?300:c.elem.width()/2,isOutAnim:!1,skin:"layui-table-tips",success:function(e,t){e.find(".layui-table-tips-c").on("click",function(){g.close(t)})}}),layui.stope(e)}),c.layBody.on("click","*[lay-event]",function(){var e=v(this),t=e.parents("tr").eq(0).data("index");layui.event.call(this,p,"tool("+s+")",d.call(this,{event:e.attr("lay-event")})),c.setThisRowChecked(t)}),c.layMain.on("scroll",function(){var e=v(this),t=e.scrollLeft(),e=e.scrollTop();c.layHeader.scrollLeft(t),c.layTotal.scrollLeft(t),c.layFixed.find(w).scrollTop(e),g.close(c.tipsIndex)}),N.on("resize",function(){c.resize()})},S.on("click",function(){S.trigger("table.remove.tool.panel")}),S.on("table.remove.tool.panel",function(){v(".layui-table-tool-panel").remove()}),x.init=function(i,a){a=a||{};var e=v(i?'table[lay-filter="'+i+'"]':".layui-table[lay-data]"),l="Table element property lay-data configuration item has a syntax error: ";return e.each(function(){var e=v(this),t=e.attr("lay-data");try{t=new Function("return "+t)()}catch(e){y.error(l+t,"error")}var n=[],o=v.extend({elem:this,cols:[],data:[],skin:e.attr("lay-skin"),size:e.attr("lay-size"),even:"string"==typeof e.attr("lay-even")},x.config,a,t);i&&e.hide(),e.find("thead>tr").each(function(a){o.cols[a]=[],v(this).children().each(function(e){var t=v(this),i=t.attr("lay-data");try{i=new Function("return "+i)()}catch(e){return y.error(l+i)}i=v.extend({title:t.text(),colspan:t.attr("colspan")||0,rowspan:t.attr("rowspan")||0},i);i.colspan<2&&n.push(i),o.cols[a].push(i)})}),e.find("tbody>tr").each(function(e){var i=v(this),l={};i.children("td").each(function(e,t){var i=v(this),a=i.data("field");if(a)return l[a]=i.html()}),layui.each(n,function(e,t){e=i.children("td").eq(e);l[t.field]=e.html()}),o.data[e]=l}),x.render(o)}),this},h.that={},h.config={},x.eachCols=function(e,i,l){var e=h.config[e]||{},n=[],o=0;l=v.extend(!0,[],l||e.cols),layui.each(l,function(t,e){layui.each(e,function(e,i){var a;i.colGroup&&(a=0,o++,i.CHILD_COLS=[],layui.each(l[t+1],function(e,t){t.PARENT_COL_INDEX||1<a&&a==i.colspan||(t.PARENT_COL_INDEX=o,i.CHILD_COLS.push(t),a+=parseInt(1<t.colspan?t.colspan:1))})),i.PARENT_COL_INDEX||n.push(i)})});var a=function(e){layui.each(e||n,function(e,t){return t.CHILD_COLS?a(t.CHILD_COLS):void("function"==typeof i&&i(e,t))})};a()},x.checkStatus=function(e){var i=0,a=0,l=[],e=x.cache[e]||[];return layui.each(e,function(e,t){"array"!==layui._typeof(t)?t[x.config.checkName]&&(i++,l.push(x.clearCacheKey(t))):a++}),{data:l,isAll:!!e.length&&i===e.length-a}},x.getData=function(e){var i=[],e=x.cache[e]||[];return layui.each(e,function(e,t){"array"!==layui._typeof(t)&&i.push(x.clearCacheKey(t))}),i},x.exportFile=function(e,t,i){var a=this;t=t||x.clearCacheKey(x.cache[e]);var o,d,l,c=h.that[e],n=h.config[e]||{},r={csv:"text/csv",xls:"application/vnd.ms-excel"}[i=i||"csv"],s=document.createElement("a");if(f.ie)return y.error("IE_NOT_SUPPORT_EXPORTS");s.href="data:"+r+";charset=utf-8,\ufeff"+encodeURIComponent((o=[],d=[],l=[],layui.each(t,function(a,l){var n=[];"object"==typeof e?(layui.each(e,function(e,t){0==a&&o.push(t||"")}),layui.each(x.clearCacheKey(l),function(e,t){n.push('"'+(t||"")+'"')})):x.eachCols(e,function(e,t){var i;t.field&&"normal"==t.type&&!t.hide&&(null==(i=l[t.field])&&(i=""),0==a&&o.push(t.title||""),n.push('"'+m.call(c,t,i,l,"text")+'"'))}),d.push(n.join(","))}),layui.each(a.dataTotal,function(e,t){l.push(t)}),o.join(",")+"\r\n"+d.join("\r\n")+"\r\n"+l.join(","))),s.download=(n.title||"table_"+(n.index||""))+"."+i,document.body.appendChild(s),s.click(),document.body.removeChild(s)},x.resize=function(e){e?a(e)&&h.that[e].resize():layui.each(h.that,function(){this.resize()})},x.reload=function(e,t,i){if(a(e)){e=h.that[e];return e.reload(t,i),h.call(e)}},x.render=function(e){e=new i(e);return h.call(e)},x.clearCacheKey=function(e){return delete(e=v.extend({},e))[x.config.checkName],delete e[x.config.indexName],e},v(function(){x.init()}),e(p,x)});